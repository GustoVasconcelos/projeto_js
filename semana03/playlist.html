<!DOCTYPE html>
<html lang="pt-BR" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atividades de JavaScript</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous" defer></script>

    <style>
        body, html {
            min-height: 100vh;
        }
    </style>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const musicaInput = document.getElementById('musicaInput');
            const btAddMusica = document.getElementById('btAddMusica');
            const listaMusical = document.getElementById('listaMusical');
            const btOrdenar = document.getElementById('btOrdenar');
            let ordemAscendente = true; // Controla o estado da ordenação
            
            musicaInput.focus();
            
            const playlist = [];

            musicaInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    adicionarMusica();
                }
            });
            btAddMusica.addEventListener('click', adicionarMusica);
            btOrdenar.addEventListener('click', ordenarPlaylist);

            function adicionarMusica() {
                const texto = musicaInput.value.trim();
                if (texto === "") {
                    alert("Por favor, digite o nome da música.");
                    musicaInput.focus();
                    return;
                }
                playlist.push(texto);
                musicaInput.value = "";
                musicaInput.focus();
                atualizarMusicas();
            }

            function ordenarPlaylist() {
                if (ordemAscendente) {
                    playlist.sort((a, b) => a.localeCompare(b));
                    btOrdenar.textContent = 'Ordenar Z-A';
                } else {
                    playlist.sort((a, b) => b.localeCompare(a));
                    btOrdenar.textContent = 'Ordenar A-Z';
                }
                ordemAscendente = !ordemAscendente;
                atualizarMusicas();
            }

            function atualizarMusicas() {
                listaMusical.innerHTML = "";

                if (playlist.length === 0) {
                     listaMusical.innerHTML = `<div class="p-3 text-center text-muted">Sua playlist está vazia. Adicione algumas músicas!</div>`;
                     return;
                }
                
                playlist.forEach((musica, index) => {
                    const divItemMusica = document.createElement('div');
                    divItemMusica.className = 'd-flex align-items-center p-2 border-bottom';

                    // --- Elemento para exibir o texto da música (inicialmente um span) ---
                    const spanMusicaTexto = document.createElement('span');
                    spanMusicaTexto.className = 'flex-grow-1 me-2 text-white';
                    spanMusicaTexto.textContent = musica;
                    divItemMusica.appendChild(spanMusicaTexto);

                    const btnEditar = document.createElement('button');
                    btnEditar.textContent = 'Editar';
                    btnEditar.className = "btn btn-outline-warning btn-sm me-2";
                    divItemMusica.appendChild(btnEditar);

                    const btnExcluir = document.createElement('button');
                    btnExcluir.textContent = 'Excluir';
                    btnExcluir.className = "btn btn-outline-danger btn-sm";
                    divItemMusica.appendChild(btnExcluir);
                    
                    listaMusical.appendChild(divItemMusica);

                    // --- EXCLUSÃO ---
                    btnExcluir.addEventListener('click', () => {
                        playlist.splice(index, 1);
                        musicaInput.focus();
                        atualizarMusicas();
                    });

                    // --- EDIÇÃO ---
                    btnEditar.addEventListener('click', () => {
                        if (btnEditar.textContent === 'Editar') {
                            // Muda para modo de edição: troca span por input
                            const inputEdicao = document.createElement('input');
                            inputEdicao.type = 'text';
                            inputEdicao.className = 'form-control flex-grow-1 me-2';
                            inputEdicao.value = spanMusicaTexto.textContent;
                            
                            // Substitui o span pelo input
                            divItemMusica.replaceChild(inputEdicao, spanMusicaTexto);
                            inputEdicao.focus(); // Coloca o foco no input
                            
                            btnEditar.textContent = 'Salvar';
                            btnEditar.classList.remove('btn-outline-warning');
                            btnEditar.classList.add('btn-outline-success');
                        } else {
                            // Muda para modo de visualização: troca input por span
                            const inputEdicao = divItemMusica.querySelector('input'); // Pega o input atual
                            const novoValor = inputEdicao.value.trim();
                            
                            if(novoValor) {
                                playlist[index] = novoValor;
                                spanMusicaTexto.textContent = novoValor; // Atualiza o texto do span
                                
                                // Substitui o input de volta pelo span
                                divItemMusica.replaceChild(spanMusicaTexto, inputEdicao);
                                
                                btnEditar.textContent = 'Editar';
                                btnEditar.classList.remove('btn-outline-success');
                                btnEditar.classList.add('btn-outline-warning');
                            } else {
                                alert("O nome da música não pode ficar vazio.");
                                inputEdicao.focus();
                            }
                        }
                    });
                });
            }
        });
    </script>
</head>
<body>
    <div class="d-flex flex-column flex-md-row align-items-start p-3 gap-3">
        
        <div class="flex-fill w-100">
            <div class="p-3 border border-info rounded h-100">
                <h1 class="mb-3">Exercício Playlist</h1>
                <ul class="list-unstyled">
                    <li class="mb-2">Criar playlist interativa com input + botões</li>
                    <li class="mb-2">Usar push, pop, sort, filter, for...of</li>
                    <li class="mb-2">Implementar um TODO List para sua playlist
                        <ul class="list-unstyled ms-3 mt-1">
                            <li>- Incluir</li>
                            <li>- Excluir</li>
                            <li>- Editar</li>
                        </ul>
                        <p class="mt-3">Não esqueça de estilizar seu TODO List e deixar bem bonito.</p>
                    </li>
                </ul>
                <a class="btn btn-secondary mt-3" href="semana03.html">Voltar</a>
            </div>
        </div>

        <div class="flex-fill w-100">
             <div class="p-3 border border-info rounded h-100">
                <h1 class="mb-3">Sua Playlist</h1>
                <div class="d-flex flex-row mt-3">
                    <input class="form-control" type="text" id="musicaInput" placeholder="Digite o nome de uma música">
                    <button class="ms-2 btn btn-secondary flex-shrink-0" id="btAddMusica">Adicionar</button>
                    <button class="ms-2 btn btn-outline-info flex-shrink-0" id="btOrdenar">Ordenar</button>
                </div>
                <div class="border border-secondary rounded mt-3" id="listaMusical">
                    <div class="p-3 text-center text-muted">
                        Sua playlist está vazia. Adicione algumas músicas!
                    </div>
                </div>
            </div>
        </div>

    </div>
</body>
</html>